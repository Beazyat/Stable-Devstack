# 🚀 آموزش نصب DevStack با فایل تنظیمات `local.conf`

این مخزن با هدف آموزش نصب DevStack برای علاقه‌مندان به OpenStack ساخته شده. مراحل نصب، پیش‌نیازها، تنظیمات مهم و نکات رفع اشکال در اینجا جمع‌آوری شده‌اند تا تجربه‌ای روان‌تر داشته باشید، مخصوصاً در مواجهه با مشکلات پس از ریستارت سیستم.

---

## 📁 ساختار فایل‌های موجود

| فایل                                                         | توضیح                                                    |
| ------------------------------------------------------------ | -------------------------------------------------------- |
| [`Openstack`](docs/Openstack.md)                             | معرفی اولیه OpenStack و متد‌های تست آن                   |
| [`How-to-install-Devstack`](docs/How-to-install-Devstack.md) | مراحل نصب DevStack با فایل کانفیگ                        |
| [`install-python-3.10`](docs/install-python-3.10.md)         | روش نصب پایتون ۳.۱۰ بدون مشکل ناسازگاری                  |
| [`Stable-devstack`](docs/Stable-devstack.md)                 | حل سه مانع اصلی پایداری Devstack                         |
| [`disk-image-format`](docs/disk-image-format.md)             | معرفی سیستم‌عامل‌ها و فرمت‌های مناسب آن‌ها برای Devstack |
| [`docs/Terms`](docs/Terms.md)                                | اصطلاحاتی که آشنایی با آن‌ها مهم است                     |
| [`scripts/`](scripts/)                                       | حاوی فایل local.conf پیشنهادی                            |
| [`assets/`](assets/)                                         | حاوی فایل تصاویر و ...                                   |



---

## 📋 پیش‌نیازهای سیستم

برای نصب DevStack بدون دردسر، بهتره سیستم یا ماشین مجازی شما مشخصات زیر رو داشته باشه:

- Ubuntu 22.04 یا مشابه
- دسترسی sudo
- حداقل 8GB RAM (ترجیحاً 16GB)
- فضای دیسک آزاد 20GB+
- نصب بودن Git، curl، و Python 3 و ...
- اتصال به اینترنت پایدار (برای دریافت بسته‌ها و در صورت امکان استفاده از VPN یا DNS)

---

## 🧰 نحوه نصب DevStack

### مراحل سریع نصب:
#### Create stack User
  در گام بعد نیاز به یک ایجاد یک کاربر داریم که بتواند از دستور محدود **sudo** استفاده نماید. خود Devstack نیز پیشنهاد می‌کند تا به جای استفاده از کاربر **Root** از این روش استفاده کرده و حتی در صورت اجرا با کاربر روت ارور می‌دهد و از شما می‌خواهد کاربر دیگری با دسترسی sudo ایجاد نمایید.   
  برای انجام این کار ابتدا کاربر مورد نظر را به همراه دایرکتوری مبدا یا خانه و همین طور Shell مورد نظر ایجاد می‌کنیم.  
```bash
sudo useradd -s /bin/bash -d /opt/stack -m stack
```
سپس برای دادن دسترسی اجرایی به اسکریپت‌های این دایرکتوری دستور زیر را وارد نمایید.  
```bash
sudo chmod +x /opt/stack
```
حال برای دادن محدوده دسترسی Sudo به این یوزر دستور زیر را وارد نمایید.  
```bash
echo "stack ALL=(ALL) NOPASSWD: ALL" | sudo tee /etc/sudoers.d/stack
```
و در مرحله آخر نیز به کاربر خود را به کاربر stack تغییر دهید:  
```bash
sudo -u stack -i
```
#### Up-to-date Packages
در گام بعد نیاز داریم که پکیج‌های موجود در توزیع‌ نصب شده بروز شوند تا در روند کار و نصب خود سیستم‌عامل یا Devstack مشکلی ایجاد نشود.  
با دستور ( فرض بر این که توزیع نصب شده شما Ubuntu است):  
```bash
sudo apt-get -u update && sudo apt-get upgrade
```
این فرآیند انجام می‌شود و می‌تواند بین ۱۰ تا ۱۵ دقیقه نیز بسته به سرعت ایترنت زمانبر باشد.  
#### Install Git
در گام بعد نیاز است تا برای فراخوانی سورس‌های Devstack از مخزن آن، **Git** را نصب نمایید.  
```bash
sudo apt-get -y install git
```
### Configure and Install Devstack
در این مرحله باید سورس‌کد‌های [Devstack](https://github.com/openstack/devstack) را با استفاده از دستور زیر فراخوانی نمایید.  
```bash
sudo git clone https://github.com/openstack-dev/devstack.git
```
**نکته:** در این روش همواره branch یا شاخه اصلی فراخوانی می‌شود. اما شما می‌توانید در صفحه گیت‌هاب برنچ‌های پایدارتر که در نام آن‌ها از کلمه **Stable** استفاده شده است را پیدا کرده و دستور قبل را بدین صورت وارد نمایید:  
```bash
git clone -b branch_name https://github.com/openstack-dev/devstack.git
```
![نحوه مشاهده و یافتن شاخه‌های پایدار](assets/screenshot1.png)
پس از این مرحله نیز وارد دایرکتوری **devstack** می‌شویم.  
```bash
cd devstack
```
#### Configure Devstack
در این مرحله ابتدا با دستور زیر فایل **local.conf** را ایجاد نمایید:  
```bash
touch local.conf
```
این فایل قرار است به ما امکان پیکربندی نحوه استقرار **Devstack** را می‌دهد؛ بطوریکه در آن می‌توانیم گذرواژه سرویس‌ها، فعال یا غیرفعال بودن آن‌ها و ... را تعیین نماییم.  
سپس با دستور زیر برای ادیت آن اقدام می‌کنیم:  
```bash
sudo nano local.conf
```
و سپس محتویات [local.conf](scripts/local.conf) ضمیمه شده را در فایل جای‌گذاری می‌کنیم.  
**نکته۱:** هم‌چنین می‌توانید برنامه را با تکست ادیتور‌های دیگر یا حتی خود vscode باز نموده و تغییرات را مانند تصویر زیر ایجاد نمایید.   
**نکته۲:** پسورد‌ها را می‌توانید بسته به میل خود تغییر دهید. در این روش پسورد پیش‌فرض **devstack** است.
#### Install Devstack
حال در همان دایرکتوری برای‌ آخرین اقدام در مرحله نصب و آماده‌سازی Devstack دستور زیر را وارد نمایید تا روند پیکربندی و نصب آن آغاز شود. این مرحله بسته به سرعت اینترنت می‌تواند ۲۰ دقیقه تا ۴۵ دقیقه زمان‌بر باشد.  
```bash
./stack.sh
```
#### How to access webclient
در پایان اجرای این اسکریپت IP صفحه وب مورد نظر برای دسترسی و کار با رابط گرافیکی Devstack داده می‌شود اما برای دسترسی به آن می‌توانید IP سیستم خود را وارد نمایید یا این که اگر IP دیگری را در فایل local.conf مشخص کرده‌اید، آن را در مرورگر خود وارد نمایید.  